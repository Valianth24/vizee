

'use strict';

const i18n = {
    // Mevcut dil
    currentLanguage: localStorage.getItem('testify_language') || 'tr',
    
    // Desteklenen diller
    languages: {
        tr: {
            name: 'TÃ¼rkÃ§e',
            flag: 'ðŸ‡¹ðŸ‡·',
            adsenseCountry: 'TR'
        },
        en: {
            name: 'English',
            flag: 'ðŸ‡¬ðŸ‡§',
            adsenseCountry: 'US'
        },
        de: {
            name: 'Deutsch',
            flag: 'ðŸ‡©ðŸ‡ª',
            adsenseCountry: 'DE'
        },
        es: {
            name: 'EspaÃ±ol',
            flag: 'ðŸ‡ªðŸ‡¸',
            adsenseCountry: 'ES'
        }
    },
    
    // Ã‡eviriler
    translations: {
        // TÃœRKÃ‡E
        tr: {
            // Header
            appName: 'Testify',
            appTagline: 'AI Destekli Test Platformu',
            
            // Navigation
            navDashboard: 'ðŸ“Š Dashboard',
            navTest: 'ðŸ“ Test Ã‡Ã¶z',
            navCreate: 'âž• Test OluÅŸtur',
            navNotes: 'ðŸ““ NotlarÄ±m',
            navLeaderboard: 'ðŸ† Liderlik',
            navAnalytics: 'ðŸ“ˆ Analizler',
            navSettings: 'âš™ï¸ Ayarlar',
            
            // Dashboard
            dashboardTitle: 'Dashboard',
            statTestsSolved: 'Ã‡Ã¶zÃ¼len Test',
            statSuccessRate: 'BaÅŸarÄ± OranÄ±',
            statTotalQuestions: 'Toplam Soru',
            statAvgTime: 'Ort. SÃ¼re',
            recentActivities: 'Son Aktiviteler',
            noActivities: 'HenÃ¼z aktivite yok. Test Ã§Ã¶zerek baÅŸla!',
            
            // Test Modes
            testModeTitle: 'Test Modu SeÃ§',
            modePractice: 'Pratik Modu',
            modePracticeDesc: 'RahatÃ§a Ã§alÄ±ÅŸ, hata yap ve Ã¶ÄŸren',
            modeExam: 'SÄ±nav Modu',
            modeExamDesc: 'GerÃ§ek sÄ±nav koÅŸullarÄ±nda kendinizi test edin',
            modeAI: 'AI Test',
            modeAIDesc: 'AI tarafÄ±ndan oluÅŸturulan Ã¶zel testler',
            modeCustom: 'Ã–zel Test',
            modeCustomDesc: 'Kendi testini kendin oluÅŸtur',
            
            // Quiz
            question: 'Soru',
            of: '/',
            timer: 'SÃ¼re',
            previous: 'â† Ã–nceki',
            next: 'Sonraki â†’',
            finish: 'âœ“ Bitir',
            
            // Results
            resultsTitle: 'Test SonuÃ§larÄ±',
            yourScore: 'PuanÄ±nÄ±z',
            correct: 'DoÄŸru',
            wrong: 'YanlÄ±ÅŸ',
            success: 'BaÅŸarÄ±',
            totalTime: 'Toplam SÃ¼re',
            review: 'ðŸ“‹ CevaplarÄ± Ä°ncele',
            newTest: 'ðŸ”„ Yeni Test',
            
            // AI Chat
            aiChatTitle: 'Testify AI',
            aiChatPlaceholder: 'Testify AI\'ya sor...',
            aiSend: 'GÃ¶nder',
            
            // Buttons
            btnStart: 'BaÅŸla',
            btnCancel: 'Ä°ptal',
            btnSave: 'Kaydet',
            btnDelete: 'Sil',
            btnEdit: 'DÃ¼zenle',
            btnClose: 'Kapat',
            
            // Messages
            msgLoading: 'YÃ¼kleniyor...',
            msgSuccess: 'Ä°ÅŸlem baÅŸarÄ±lÄ±!',
            msgError: 'Bir hata oluÅŸtu!',
            msgConfirm: 'Emin misiniz?',
            
            // Ads
            adLabel: 'Sponsorlu',
            adLabelAlt: 'Reklam',
            adSponsoredContent: 'Sponsorlu Ä°Ã§erik'
        },
        
        // ENGLISH
        en: {
            appName: 'Testify',
            appTagline: 'AI-Powered Test Platform',
            
            navDashboard: 'ðŸ“Š Dashboard',
            navTest: 'ðŸ“ Take Test',
            navCreate: 'âž• Create Test',
            navNotes: 'ðŸ““ My Notes',
            navLeaderboard: 'ðŸ† Leaderboard',
            navAnalytics: 'ðŸ“ˆ Analytics',
            navSettings: 'âš™ï¸ Settings',
            
            dashboardTitle: 'Dashboard',
            statTestsSolved: 'Tests Solved',
            statSuccessRate: 'Success Rate',
            statTotalQuestions: 'Total Questions',
            statAvgTime: 'Avg. Time',
            recentActivities: 'Recent Activities',
            noActivities: 'No activities yet. Start by taking a test!',
            
            testModeTitle: 'Choose Test Mode',
            modePractice: 'Practice Mode',
            modePracticeDesc: 'Learn comfortably, make mistakes and grow',
            modeExam: 'Exam Mode',
            modeExamDesc: 'Test yourself under real exam conditions',
            modeAI: 'AI Test',
            modeAIDesc: 'Custom tests generated by AI',
            modeCustom: 'Custom Test',
            modeCustomDesc: 'Create your own personalized test',
            
            question: 'Question',
            of: 'of',
            timer: 'Time',
            previous: 'â† Previous',
            next: 'Next â†’',
            finish: 'âœ“ Finish',
            
            resultsTitle: 'Test Results',
            yourScore: 'Your Score',
            correct: 'Correct',
            wrong: 'Wrong',
            success: 'Success',
            totalTime: 'Total Time',
            review: 'ðŸ“‹ Review Answers',
            newTest: 'ðŸ”„ New Test',
            
            aiChatTitle: 'Testify AI',
            aiChatPlaceholder: 'Ask Testify AI...',
            aiSend: 'Send',
            
            btnStart: 'Start',
            btnCancel: 'Cancel',
            btnSave: 'Save',
            btnDelete: 'Delete',
            btnEdit: 'Edit',
            btnClose: 'Close',
            
            msgLoading: 'Loading...',
            msgSuccess: 'Success!',
            msgError: 'An error occurred!',
            msgConfirm: 'Are you sure?',
            
            adLabel: 'Sponsored',
            adLabelAlt: 'Advertisement',
            adSponsoredContent: 'Sponsored Content'
        },
        
        // DEUTSCH
        de: {
            appName: 'Testify',
            appTagline: 'KI-gestÃ¼tzte Testplattform',
            
            navDashboard: 'ðŸ“Š Dashboard',
            navTest: 'ðŸ“ Test machen',
            navCreate: 'âž• Test erstellen',
            navNotes: 'ðŸ““ Meine Notizen',
            navLeaderboard: 'ðŸ† Rangliste',
            navAnalytics: 'ðŸ“ˆ Analysen',
            navSettings: 'âš™ï¸ Einstellungen',
            
            dashboardTitle: 'Dashboard',
            statTestsSolved: 'GelÃ¶ste Tests',
            statSuccessRate: 'Erfolgsquote',
            statTotalQuestions: 'Gesamtfragen',
            statAvgTime: 'Durchschn. Zeit',
            recentActivities: 'Letzte AktivitÃ¤ten',
            noActivities: 'Noch keine AktivitÃ¤ten. Starten Sie mit einem Test!',
            
            testModeTitle: 'Testmodus wÃ¤hlen',
            modePractice: 'Ãœbungsmodus',
            modePracticeDesc: 'Lernen Sie bequem, machen Sie Fehler und wachsen Sie',
            modeExam: 'PrÃ¼fungsmodus',
            modeExamDesc: 'Testen Sie sich unter echten PrÃ¼fungsbedingungen',
            modeAI: 'KI-Test',
            modeAIDesc: 'Von KI generierte benutzerdefinierte Tests',
            modeCustom: 'Benutzerdefinierter Test',
            modeCustomDesc: 'Erstellen Sie Ihren eigenen personalisierten Test',
            
            question: 'Frage',
            of: 'von',
            timer: 'Zeit',
            previous: 'â† ZurÃ¼ck',
            next: 'Weiter â†’',
            finish: 'âœ“ Beenden',
            
            resultsTitle: 'Testergebnisse',
            yourScore: 'Ihre Punktzahl',
            correct: 'Richtig',
            wrong: 'Falsch',
            success: 'Erfolg',
            totalTime: 'Gesamtzeit',
            review: 'ðŸ“‹ Antworten Ã¼berprÃ¼fen',
            newTest: 'ðŸ”„ Neuer Test',
            
            aiChatTitle: 'Testify KI',
            aiChatPlaceholder: 'Fragen Sie Testify KI...',
            aiSend: 'Senden',
            
            btnStart: 'Start',
            btnCancel: 'Abbrechen',
            btnSave: 'Speichern',
            btnDelete: 'LÃ¶schen',
            btnEdit: 'Bearbeiten',
            btnClose: 'SchlieÃŸen',
            
            msgLoading: 'Wird geladen...',
            msgSuccess: 'Erfolg!',
            msgError: 'Ein Fehler ist aufgetreten!',
            msgConfirm: 'Sind Sie sicher?',
            
            adLabel: 'Gesponsert',
            adLabelAlt: 'Werbung',
            adSponsoredContent: 'Gesponserter Inhalt'
        },
        
        // ESPAÃ‘OL
        es: {
            appName: 'Testify',
            appTagline: 'Plataforma de Pruebas con IA',
            
            navDashboard: 'ðŸ“Š Panel',
            navTest: 'ðŸ“ Hacer Prueba',
            navCreate: 'âž• Crear Prueba',
            navNotes: 'ðŸ““ Mis Notas',
            navLeaderboard: 'ðŸ† ClasificaciÃ³n',
            navAnalytics: 'ðŸ“ˆ AnalÃ­ticas',
            navSettings: 'âš™ï¸ Ajustes',
            
            dashboardTitle: 'Panel de Control',
            statTestsSolved: 'Pruebas Resueltas',
            statSuccessRate: 'Tasa de Ã‰xito',
            statTotalQuestions: 'Preguntas Totales',
            statAvgTime: 'Tiempo Promedio',
            recentActivities: 'Actividades Recientes',
            noActivities: 'Â¡AÃºn no hay actividades. Comienza haciendo una prueba!',
            
            testModeTitle: 'Elige el Modo de Prueba',
            modePractice: 'Modo PrÃ¡ctica',
            modePracticeDesc: 'Aprende cÃ³modamente, comete errores y crece',
            modeExam: 'Modo Examen',
            modeExamDesc: 'PruÃ©bate bajo condiciones reales de examen',
            modeAI: 'Prueba IA',
            modeAIDesc: 'Pruebas personalizadas generadas por IA',
            modeCustom: 'Prueba Personalizada',
            modeCustomDesc: 'Crea tu propia prueba personalizada',
            
            question: 'Pregunta',
            of: 'de',
            timer: 'Tiempo',
            previous: 'â† Anterior',
            next: 'Siguiente â†’',
            finish: 'âœ“ Terminar',
            
            resultsTitle: 'Resultados de la Prueba',
            yourScore: 'Tu PuntuaciÃ³n',
            correct: 'Correctas',
            wrong: 'Incorrectas',
            success: 'Ã‰xito',
            totalTime: 'Tiempo Total',
            review: 'ðŸ“‹ Revisar Respuestas',
            newTest: 'ðŸ”„ Nueva Prueba',
            
            aiChatTitle: 'Testify IA',
            aiChatPlaceholder: 'Pregunta a Testify IA...',
            aiSend: 'Enviar',
            
            btnStart: 'Comenzar',
            btnCancel: 'Cancelar',
            btnSave: 'Guardar',
            btnDelete: 'Eliminar',
            btnEdit: 'Editar',
            btnClose: 'Cerrar',
            
            msgLoading: 'Cargando...',
            msgSuccess: 'Â¡Ã‰xito!',
            msgError: 'Â¡OcurriÃ³ un error!',
            msgConfirm: 'Â¿EstÃ¡s seguro?',
            
            adLabel: 'Patrocinado',
            adLabelAlt: 'Publicidad',
            adSponsoredContent: 'Contenido Patrocinado'
        }
    },
    
    /**
     * DÄ°L DEÄžÄ°ÅžTÄ°R
     */
    setLanguage(lang) {
        if (!this.languages[lang]) {
            console.error('Desteklenmeyen dil:', lang);
            return;
        }
        
        this.currentLanguage = lang;
        localStorage.setItem('testify_language', lang);
        
        // SayfayÄ± gÃ¼ncelle
        this.updatePage();
        
        // ReklamlarÄ± gÃ¼ncelle
        if (window.AdsManager) {
            AdsManager.updateLanguage(lang);
        }
        
        console.log(`ðŸŒ Dil deÄŸiÅŸtirildi: ${this.languages[lang].name}`);
    },
    
    /**
     * Ã‡EVÄ°RÄ° AL
     */
    t(key) {
        return this.translations[this.currentLanguage][key] || key;
    },
    
    /**
     * SAYFAYI GÃœNCELLE
     */
    updatePage() {
        // TÃ¼m data-i18n elementlerini gÃ¼ncelle
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.t(key);
            
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // HTML lang attribute gÃ¼ncelle
        document.documentElement.lang = this.currentLanguage;
        
        console.log('âœ… Sayfa Ã§evirileri gÃ¼ncellendi');
    },
    
    /**
     * DÄ°L SEÃ‡Ä°CÄ° OLUÅžTUR
     */
    createLanguageSelector() {
        const header = document.querySelector('.header-actions');
        if (!header) return;
        
        // Mevcut selector'Ä± kaldÄ±r
        const existing = document.getElementById('languageSelector');
        if (existing) existing.remove();
        
        const selector = document.createElement('div');
        selector.id = 'languageSelector';
        selector.className = 'language-selector';
        
        const currentLang = this.languages[this.currentLanguage];
        
        selector.innerHTML = `
            <button class="language-button" id="langBtn">
                <span class="language-flag">${currentLang.flag}</span>
                <span class="language-name">${currentLang.name}</span>
                <span class="language-arrow">â–¼</span>
            </button>
            <div class="language-dropdown" id="langDropdown">
                ${Object.entries(this.languages).map(([code, lang]) => `
                    <button class="language-option ${code === this.currentLanguage ? 'active' : ''}" 
                            onclick="i18n.setLanguage('${code}')">
                        <span class="language-flag">${lang.flag}</span>
                        <span class="language-name">${lang.name}</span>
                        ${code === this.currentLanguage ? '<span class="language-check">âœ“</span>' : ''}
                    </button>
                `).join('')}
            </div>
        `;
        
        // Theme toggle'dan Ã¶nce ekle
        const themeToggle = header.querySelector('.theme-toggle');
        if (themeToggle) {
            header.insertBefore(selector, themeToggle);
        } else {
            header.appendChild(selector);
        }
        
        // Dropdown toggle
        const btn = selector.querySelector('#langBtn');
        const dropdown = selector.querySelector('#langDropdown');
        
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            dropdown.classList.toggle('show');
        });
        
        // DÄ±ÅŸarÄ± tÄ±klanÄ±nca kapat
        document.addEventListener('click', () => {
            dropdown.classList.remove('show');
        });
        
        console.log('âœ… Dil seÃ§ici oluÅŸturuldu');
    },
    
    /**
     * BAÅžLAT
     */
    init() {
        console.log('ðŸŒ i18n baÅŸlatÄ±lÄ±yor...');
        
        // Dil seÃ§iciyi oluÅŸtur
        this.createLanguageSelector();
        
        // SayfayÄ± gÃ¼ncelle
        this.updatePage();
        
        console.log(`âœ… i18n hazÄ±r - Dil: ${this.languages[this.currentLanguage].name}`);
    }
};

// BaÅŸlat
document.addEventListener('DOMContentLoaded', () => {
    i18n.init();
});

window.i18n = i18n;
